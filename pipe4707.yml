pipelines:
  - name: pipeline_affinityGroup_example1
    configuration:
      environmentVariables:
        readOnly:
          MY_DIR: "/tmpdir"
    steps:
      - name: ag_step_1
        type: Bash
        inputResources:
          - name: myAppRepo
        execution:
          onExecute:
            - mkdir $MY_DIR
            - echo "Running " $pipeline_name "|" $step_name >$MY_DIR/myoutput.txt
            - cat $MY_DIR/myoutput.txt
            - touch foo
            - restore_pipeline_files myfile cachefile.txt
      - name: bad
        type: Bash
        configuration:
          inputSteps:
            - name: ag_step_1
        execution:
          onStart:
            - restore_pipeline_files my_file cachefile.txt
          onExecute:
            - echo "Hello world"
            - cat $MY_DIR/myoutput.txt